import{h as m,K as N,d as s,o as t,a as o,b,r as M,w as d,j as _,n as R,t as w,J as K,D as j,Q as q,T as Q,e as L,l as z,g as i,m as H,p as I,i as T,F as U,k as G,c as y,N as $}from"./app-DEkwZWrq.js";import{a as J}from"./DialogModal-CfbbiHhh.js";import{_ as P}from"./InputError-hNK4lZzv.js";import{_ as O}from"./PrimaryButton-CR6vKdh8.js";import W from"./SecondaryButton-BDANIfXV.js";import{_ as X}from"./TextInput-he-H6cc7.js";const Y={class:"mt-4"},v={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(x,{emit:C}){const h=C,c=m(!1),e=N({password:"",error:"",processing:!1}),g=m(null),f=()=>{axios.get(route("password.confirmation")).then(r=>{r.data.confirmed?h("confirmed"):(c.value=!0,setTimeout(()=>g.value.focus(),250))})},p=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,l(),j().then(()=>h("confirmed"))}).catch(r=>{e.processing=!1,e.error=r.response.data.errors.password[0],g.value.focus()})},l=()=>{c.value=!1,e.password="",e.error=""};return(r,n)=>(t(),s("span",null,[o("span",{onClick:f},[M(r.$slots,"default")]),b(J,{show:c.value,onClose:l},{title:d(()=>[_(w(x.title),1)]),content:d(()=>[_(w(x.content)+" ",1),o("div",Y,[b(X,{ref_key:"passwordInput",ref:g,modelValue:e.password,"onUpdate:modelValue":n[0]||(n[0]=F=>e.password=F),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:K(p,["enter"])},null,8,["modelValue"]),b(P,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:d(()=>[b(W,{onClick:l},{default:d(()=>n[1]||(n[1]=[_(" Cancel ")])),_:1}),b(O,{class:R(["ms-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:p},{default:d(()=>[_(w(x.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},Z={class:"bg-white dark:bg-gray-800 shadow-md border border-gray-200 dark:border-gray-700 p-6 mx-auto"},ee={class:"text-sm mb-5"},te={key:0,class:"text-green-600 font-medium"},oe={key:1,class:"text-yellow-500 font-medium"},ae={key:2,class:"text-gray-500 dark:text-gray-400"},se={key:0,class:"space-y-6"},re={key:0,class:"bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl p-4 text-sm text-gray-800 dark:text-gray-100"},ne={key:0,class:"mb-2"},ie={key:1},de=["innerHTML"],le={key:2,class:"mt-4 font-medium"},ue={class:"font-mono"},ce={key:3,class:"mt-4"},me={key:1,class:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md border text-sm text-gray-700 dark:text-gray-200"},ge={class:"grid grid-cols-2 gap-2 font-mono"},pe={class:"flex flex-wrap justify-end gap-3 mt-8"},fe=["disabled"],ye=["disabled"],_e={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(x){const C=x,h=q(),c=m(!1),e=m(!1),g=m(!1),f=m(null),p=m(null),l=m([]),r=Q({code:""}),n=L(()=>{var u;return!c.value&&((u=h.props.auth.user)==null?void 0:u.two_factor_enabled)});z(n,()=>{n.value||(r.reset(),r.clearErrors())});const F=()=>{c.value=!0,$.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([B(),D(),S()]),onFinish:()=>{c.value=!1,e.value=C.requiresConfirmation}})},B=()=>axios.get(route("two-factor.qr-code")).then(u=>{f.value=u.data.svg}),D=()=>axios.get(route("two-factor.secret-key")).then(u=>{p.value=u.data.secretKey}),S=()=>axios.get(route("two-factor.recovery-codes")).then(u=>{l.value=u.data}),A=()=>{r.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{e.value=!1,f.value=null,p.value=null}})},E=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>S())},V=()=>{g.value=!0,$.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{g.value=!1,e.value=!1}})};return(u,a)=>(t(),s("section",Z,[a[8]||(a[8]=o("header",{class:"mb-6 text-center"},[o("h2",{class:"text-2xl font-bold text-gray-800 dark:text-white"},"Autenticação em Duas Etapas"),o("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Adicione uma camada extra de segurança à sua conta. ")],-1)),o("div",ee,[n.value&&!e.value?(t(),s("p",te," A autenticação em duas etapas está ativada. ")):n.value&&e.value?(t(),s("p",oe," Finalize a ativação da autenticação em duas etapas. ")):(t(),s("p",ae," A autenticação em duas etapas não está ativada. "))]),n.value?(t(),s("div",se,[f.value?(t(),s("div",re,[e.value?(t(),s("p",ne," Escaneie o QR Code abaixo no seu aplicativo autenticador ou digite a chave de configuração. ")):(t(),s("p",ie," 2FA ativado. Você pode adicionar este QR Code em um novo dispositivo se desejar. ")),o("div",{class:"flex justify-center mt-3",innerHTML:f.value},null,8,de),p.value?(t(),s("p",le,[a[1]||(a[1]=o("span",{class:"text-gray-800 dark:text-white"},"Chave de configuração:",-1)),o("span",ue,w(p.value),1)])):i("",!0),e.value?(t(),s("div",ce,[a[2]||(a[2]=o("label",{for:"code",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Código de Verificação ",-1)),H(o("input",{id:"code","onUpdate:modelValue":a[0]||(a[0]=k=>T(r).code=k),type:"text",inputmode:"numeric",autocomplete:"one-time-code",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm focus:ring-2 focus:ring-violet-500 focus:outline-none text-gray-800 dark:text-white",placeholder:"Digite o código do aplicativo",onKeyup:K(A,["enter"])},null,544),[[I,T(r).code]]),b(P,{message:T(r).errors.code,class:"mt-1 text-xs text-red-500"},null,8,["message"])])):i("",!0)])):i("",!0),l.value.length>0&&!e.value?(t(),s("div",me,[a[3]||(a[3]=o("p",{class:"mb-2 font-medium"}," Guarde os códigos abaixo com segurança. Eles são sua última opção de acesso. ",-1)),o("div",ge,[(t(!0),s(U,null,G(l.value,k=>(t(),s("div",{key:k},w(k),1))),128))])])):i("",!0)])):i("",!0),o("div",pe,[n.value?i("",!0):(t(),y(v,{key:0,onConfirmed:F},{default:d(()=>[o("button",{type:"button",disabled:c.value,class:"bg-violet-600 hover:bg-violet-700 text-white px-5 py-2 rounded-lg text-sm font-medium transition disabled:opacity-50 disabled:cursor-not-allowed"}," Ativar ",8,fe)]),_:1})),e.value?(t(),y(v,{key:1,onConfirmed:A},{default:d(()=>a[4]||(a[4]=[o("button",{type:"button",class:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg text-sm font-medium transition"}," Confirmar ",-1)])),_:1})):i("",!0),l.value.length&&!e.value?(t(),y(v,{key:2,onConfirmed:E},{default:d(()=>a[5]||(a[5]=[o("button",{type:"button",class:"bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 text-sm text-gray-800 dark:text-white px-4 py-2 rounded-lg transition"}," Regenerar Códigos ",-1)])),_:1})):i("",!0),!l.value.length&&!e.value?(t(),y(v,{key:3,onConfirmed:S},{default:d(()=>a[6]||(a[6]=[o("button",{type:"button",class:"bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 text-sm text-gray-800 dark:text-white px-4 py-2 rounded-lg transition"}," Mostrar Códigos ",-1)])),_:1})):i("",!0),e.value?(t(),y(v,{key:4,onConfirmed:V},{default:d(()=>a[7]||(a[7]=[o("button",{type:"button",class:"bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 text-sm text-gray-800 dark:text-white px-4 py-2 rounded-lg transition"}," Cancelar ",-1)])),_:1})):i("",!0),e.value?i("",!0):(t(),y(v,{key:5,onConfirmed:V},{default:d(()=>[o("button",{type:"button",disabled:g.value,class:"bg-red-600 hover:bg-red-700 text-white px-5 py-2 rounded-lg text-sm font-medium transition disabled:opacity-50 disabled:cursor-not-allowed"}," Desativar ",8,ye)]),_:1}))])]))}};export{_e as default};
